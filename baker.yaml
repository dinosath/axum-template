schemaVersion: v1
template_globs:
  - "**/*.jinja"
  - "*.jinja"

questions:
  project_name:
    type: str
    help: Please enter the name of your application
    default: "my_app"

  project_author:
    type: str
    help: "Please enter the author's name for {{project_name}}"

  project_version:
    type: str
    help: Please enter the version of the project
    default: "0.1.0"

  project_edition:
    type: str
    help: Please enter the edition of the project
    default: "2021"

  authentication:
    type: str
    help: What authentication method do you want to use?
    default: oidc
    choices:
      - oidc
      - none

  database:
    type: str
    help: What database do you want to use?
    default: postgres
    choices:
      - postgres

  db_schema:
    type: str
    help: What PostgreSQL schema should tables be created in?
    default: public
    ask_if: database == 'postgres'

  id_type:
    type: str
    help: What type should primary keys use?
    default: integer
    choices:
      - integer
      - uuid
      - big_integer

  features:
    type: str
    help: What features do you want to enable?
    multiselect: true
    default:
      - open-telemetry
    choices:
      - open-telemetry

  protocol:
    type: str
    help: What protocol to generate the API with?
    default: rest
    choices:
      - rest
      - grpc

  crudcrate:
    type: bool
    help: Do you want to use crudcrate for generation of rest controllers?
    default: false
    ask_if: protocol == 'rest'

  static_includes:
    help: |
      Array of objects mapping URL mount points to relative directories to include & serve statically.
      Each object must have:
        - route: URL path prefix (e.g. /assets)
        - assets_dir: relative directory path (e.g. frontend/dist)
      Example: [{"route": "/assets", "assets_dir": "frontend/dist"}]
    type: json
    schema: |
      {
        "type": "array",
        "items": {
          "type": "object",
          "required": ["route", "assets_dir"],
          "additionalProperties": false,
          "properties": {
            "route": {
              "type": "string",
              "pattern": "^/.*$",
              "description": "Mount point URL path (must start with /)"
            },
            "assets_dir": {
              "type": "string",
              "description": "Relative directory path to include"
            }
          }
        }
      }
    default: |
      []

  entities:
    type: json
    help: Configure your entities
    schema: |
        {
          "type": "object",
          "patternProperties": {
            "^.+$": {
              "$ref": "https://json-schema.org/draft/2020-12/schema"
            }
          },
          "additionalProperties": false
        }
    default: |
      {
      }